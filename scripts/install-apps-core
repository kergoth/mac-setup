#!/bin/bash

set -euo pipefail

scriptdir="$(cd "$(dirname "$0")" && pwd -P)"
PATH="${HOMEBREW_PREFIX:-$(brew --prefix 2>/dev/null || echo /opt/homebrew)}/bin:$scriptdir:$PATH"

brew bundle --verbose --file=$scriptdir/Brewfile-core

install-python

# The bug ostiarius fixes in El Capitan was fixed by Apple in macOS Sierra
osx_version="$(sw_vers -productVersion)"
case "$osx_version" in
    10.11*)
        brew cask install ostiarius
        ;;
esac

# Extra installers
if [ -d /opt/homebrew/Caskroom/whatsyoursign ]; then
    open /opt/homebrew/Caskroom/whatsyoursign/*/WhatsYourSign_Installer.app 2>/dev/null
fi

# Reload the Quick Look generators list
qlmanage -r
